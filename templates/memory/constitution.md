# 项目宪法 (Project Constitution)

## 核心原则

### I. 规范驱动开发 (Specification-Driven Development)
每个功能从业务需求开始，严格区分业务逻辑与技术实现：
- 需求阶段仅关注业务功能（WHAT），严禁涉及技术实现（HOW）
- 设计阶段负责技术决策和架构，基于已批准的需求
- 实现阶段严格按照设计文档和任务清单执行

### II. 测试驱动开发 (Test-Driven Development - 不可协商)
TDD为强制性要求，红-绿-重构循环严格执行：
- 测试必须先于实现编写
- 每个需求(REQ-XXX)都必须有对应的测试用例
- 测试必须先失败(RED)，然后实现功能使其通过(GREEN)
- Git提交历史必须体现测试优先的开发顺序

### III. 模块化架构 (Modular Architecture)
采用清晰的模块边界和职责分离：
- 每个功能作为独立的模块开发
- 模块之间通过明确的接口交互
- 支持嵌套模块结构用于复杂功能分解
- 避免循环依赖和紧耦合

### IV. 增量开发 (Incremental Development)
优先考虑最佳实践、增量进展和早期验证：
- 任何阶段都不允许复杂性的大跳跃
- 每个任务都建立在前一个任务的基础上
- 尽早集成和测试，及时发现问题
- 保持系统在任何时刻都处于可工作状态

### V. 简洁性原则 (Simplicity First)
遵循YAGNI原则，避免过度设计：
- 从最简单的实现开始
- 只在有明确需求时才增加复杂性
- 重构优于重写
- 优先使用标准库和成熟的框架

## 质量门禁

### 设计阶段检查点
在进入实现阶段前，必须通过以下检查：
- 所有需求都有对应的设计方案
- 架构决策有明确的理由和权衡分析
- 测试策略完整，覆盖所有验收标准
- 技术风险已识别并有应对方案

### 实现阶段检查点
每个开发任务完成前，必须满足：
- 对应的测试用例已编写并通过
- 代码符合项目编码规范
- 所有公共接口都有文档
- 没有遗留的TODO或FIXME标记

### 集成阶段检查点
功能集成前的必要条件：
- 所有单元测试通过
- 集成测试验证了模块间交互
- 端到端测试覆盖了用户场景
- 性能指标在可接受范围内

## 开发流程约束

### 五步工作流程
严格按照以下顺序执行，不允许跳过步骤：
1. **模块创建**: 定义模块边界和基础结构
2. **需求分析**: 纯业务功能描述，使用EARS格式
3. **技术设计**: 架构方案和实现策略
4. **任务规划**: 具体可执行的编码任务
5. **进度同步**: 状态更新和路线图维护

### 文档要求
每个模块必须维护以下文档：
- `spec.md`: 业务需求和验收标准
- `design.md`: 技术设计和架构决策
- `todo.md`: 任务清单和实现计划
- 所有文档必须保持最新状态

### 代码提交规范
Git提交必须遵循以下规则：
- 提交历史体现TDD流程（测试先于实现）
- 每个提交有清晰的描述和目的
- 避免大规模的批量提交
- 关联对应的需求ID或任务编号

## 技术约束

### 依赖管理
- 优先使用项目已有的技术栈
- 引入新依赖需要明确的理由和批准
- 避免重复造轮子，复用已有组件
- 考虑长期维护成本

### 性能要求
- 响应时间目标: 用户交互 < 200ms
- 批处理操作提供进度指示
- 内存使用控制在合理范围
- 支持并发操作不阻塞主流程

### 安全考虑
- 所有用户输入必须验证
- 敏感信息不得硬编码
- 错误信息不暴露内部实现
- 遵循最小权限原则

## 项目特定约束

### AI助手协作
- 支持多种AI助手（Claude、Copilot、Gemini、Cursor、Codebuddy）
- 命令格式保持一致性
- 上下文信息自动传递
- 保持工作流的可移植性

### 本地化支持
- 模板和文档支持中英文
- 命令输出适配不同语言环境
- 保持国际化友好的设计

### 跨平台兼容
- 脚本同时支持Bash和PowerShell
- 路径处理考虑Windows/Unix差异
- 避免平台特定的依赖

## 治理规则

### 宪法优先级
本宪法超越所有其他实践和约定：
- 所有设计决策必须验证宪法合规性
- 违反宪法的方案必须提供充分理由
- 复杂性增加必须有明确的业务价值
- 架构变更需要宪法合规性审查

### 修正流程
宪法修改需要完整的文档和批准：
- 提供修改理由和影响分析
- 评估对现有项目的影响
- 制定迁移计划和时间表
- 更新版本号和修改日期

### 质量保证
所有PR/评审必须验证合规性：
- 设计阶段的宪法检查是强制性的
- 实现必须遵循TDD原则
- 使用自动化工具辅助合规检查
- 定期进行架构健康度评估

**版本**: 1.0.0 | **制定日期**: 2025-01-16 | **最后修改**: 2025-01-16