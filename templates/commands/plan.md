---
description: 基于模块需求规范执行技术设计规划，生成完整的实现方案和设计文档
scripts:
  node: node .specify/scripts/setup-module-plan.js --json
---

在当前模块目录中执行技术设计规划，基于spec.md生成完整的技术实现方案。

**适配模块化架构：在模块上下文中进行技术设计，考虑模块间的依赖和接口**

执行步骤：

1. 运行 `{SCRIPT}` 获取当前模块路径和上下文，解析MODULE_PATH, MODULE_SPEC, PLAN_FILE等路径
2. 检查当前模块目录中的spec.md是否存在且完整
3. 如果spec.md不存在，提示用户先执行 `/specify` 创建需求规范
4. 读取并分析当前模块的功能规范：
   - 理解业务需求和用户故事
   - 识别功能性和非功能性需求
   - 分析验收标准和约束条件
   - 了解与其他模块的依赖关系

5. 读取项目宪法 `.specify/memory/constitution.md` 了解技术规范和约束

6. 执行模块化的实现规划：
   - 加载 `.specify/templates/plan-template.md` 作为规划模板
   - 设置输入为当前模块的spec.md
   - 执行完整的规划流程（Phase 0-2）
   - 在当前模块目录中生成设计文档：
     * plan.md - 总体实现规划
     * research.md - 技术调研和决策
     * data-model.md - 数据模型设计
     * contracts/ - API接口定义
     * quickstart.md - 测试场景设计
   - 融合用户提供的技术上下文：{ARGS}
   - 考虑模块间的接口设计和依赖管理

7. 验证规划执行完成：
   - 检查所有必需的设计文档是否生成
   - 确认没有错误状态
   - 验证与其他模块的接口一致性

8. 报告完成状态，包括模块路径、生成的设计文档清单，以及下一步执行 `/tasks` 的指导

**模块化设计特性**：
- 自动分析当前模块在整体架构中的位置
- 考虑模块间的数据流和调用关系
- 生成标准化的模块接口定义
- 支持模块的独立部署和测试策略

**技术规划原则**：
- 遵循项目宪法的技术约束和最佳实践
- 优先考虑模块的可测试性和可维护性
- 设计清晰的模块边界和接口契约
- 支持增量开发和持续集成

**完成技术规划后的指导：**

**✅ 技术设计规划完成！**

**下一步建议：**
- 在当前模块目录执行 `/tasks` 生成具体的开发任务
- 检查生成的接口定义是否与依赖模块兼容
- 确认技术方案符合整体架构要求
- 完成开发后记得执行 `/progress` 同步项目整体进度

**重要说明：**
- 本命令基于当前模块的spec.md进行技术设计
- 生成的设计文档为tasks阶段提供技术输入
- 支持模块级别的技术决策和架构演进

使用绝对路径进行所有文件操作，确保设计文档与模块结构对应。