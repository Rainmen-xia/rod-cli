# ROD 默认工作流模板

## 概述

这是 ROD CLI 的默认工作流模板，为规范驱动开发提供通用的项目初始化支持。此模板适用于大多数软件开发项目，提供标准的五阶段开发工作流。

## 工作流模板结构

```
templates/
├── commands/              # AI 助手命令（必需）
│   ├── module.md          # 创建新模块
│   ├── specify.md         # 功能规范定义
│   ├── plan.md           # 技术方案设计
│   ├── tasks.md          # 任务分解和执行
│   └── progress.md       # 进度同步管理
├── memory/               # 项目宪法（必需）
│   └── constitution.md   # ROD 开发原则和约束
├── scripts/              # Node.js 自动化脚本（必需）
│   ├── analyze-modules.js    # 模块分析工具
│   ├── check-module-status.js # 模块状态检查
│   ├── create-module.js      # 模块创建脚本
│   ├── create-module-spec.js # 模块规范生成
│   ├── generate-module-tasks.js # 任务生成
│   ├── sync-progress.js      # 进度同步
│   ├── common.js            # 通用工具函数
│   └── ...                  # 其他辅助脚本
└── templates/            # 文档模板（必需）
    ├── spec-template.md      # 功能规范模板
    ├── plan-template.md      # 技术设计模板
    ├── tasks-template.md     # 任务规划模板
    └── roadmap-template.md   # 项目路线图模板
```

## ROD 五阶段工作流

此默认模板实现标准的 ROD 开发工作流，适用于各种技术栈和项目类型：

### 1. 🏗️ 模块初始化 (`/module`)
- **命令**: `module.md`
- **作用**: 创建新的功能模块目录结构
- **输出**: `specs/modules/{模块名}/` 目录和基础文件
- **适用**: 所有项目类型的模块化开发

### 2. 📋 需求规范 (`/specify`)
- **命令**: `specify.md`
- **作用**: 基于 `spec-template.md` 创建详细的功能规范
- **输出**: `spec.md` - 包含业务需求和验收标准
- **适用**: 功能设计阶段，明确需求边界

### 3. 🎯 技术设计 (`/plan`)
- **命令**: `plan.md`
- **作用**: 基于 `plan-template.md` 生成技术实现方案
- **输出**: `plan.md` - 包含架构设计和技术决策
- **适用**: 技术方案设计，架构规划

### 4. ✅ 任务执行 (`/tasks`)
- **命令**: `tasks.md`
- **作用**: 基于 `tasks-template.md` 分解开发任务
- **输出**: `tasks.md` - 包含具体的开发和测试任务
- **适用**: 开发实施阶段，任务管理

### 5. 🔄 进度同步 (`/progress`)
- **命令**: `progress.md`
- **作用**: 同步模块进度到项目路线图
- **输出**: 更新 `specs/roadmap.md` 项目整体状态
- **适用**: 项目管理，进度跟踪

## 通用设计原则

### 技术栈无关性
- 支持前端、后端、移动端、桌面应用等各种项目
- 不绑定特定技术栈或框架
- 通过模板参数适配不同技术环境

### 模块化架构
- 支持大型项目的模块化开发
- 清晰的模块边界和依赖关系
- 递归模块结构，支持子模块

### 增量开发
- 每个阶段独立完成，可逐步推进
- 支持迭代开发和敏捷方法
- 清晰的检查点和质量门禁

## 模板文件结构规范

### 1. 文件命名
- 所有命令文件使用 `.md` 扩展名
- 文件名应简洁明了，反映命令的主要功能
- 使用小写字母和连字符分隔，如 `module.md`, `specify.md`

### 2. 文件结构
每个命令文件必须包含以下部分：

#### Front Matter（必需）
```yaml
---
description: 命令的简短描述，说明其主要功能
scripts:
  node: node .specify/scripts/script-name.js --json {ARGS}
---
```

#### 命令说明（必需）
- 简要介绍命令的用途和价值
- 使用清晰的中文描述

#### 用法示例（推荐）
```markdown
**用法示例：**
- `/command arg1` - 单个参数示例
- `/command arg1 arg2` - 多个参数示例
```

#### 执行步骤（必需）
```markdown
**执行步骤：**
1. 步骤一的详细描述
2. 步骤二的详细描述
3. 输出结果和下一步指导
```

#### 下一步指导（推荐）
```markdown
**下一步：**
指导用户执行后续命令或操作
```

### 3. 脚本引用规范
- 脚本路径使用相对路径 `.specify/scripts/`
- 使用 Node.js (`node`) 统一脚本执行环境
- 参数传递使用 `{ARGS}` 占位符
- 依赖 Node.js 内置模块，无需额外依赖

## 文档模板说明

### templates/ 目录结构
默认工作流提供四个核心文档模板，位于 `templates/templates/` 目录：

#### 1. `spec-template.md` - 功能规范模板
- **用途**: 定义功能的业务需求和验收标准
- **结构**: 使用 EARS 格式（易于评审、可实现、明确、相关、可测试）
- **占位符**: `[功能名称]`、`[业务场景]`、`[验收标准]` 等
- **适用**: 需求分析阶段，产品功能定义

#### 2. `plan-template.md` - 技术设计模板
- **用途**: 生成技术实现方案和架构设计
- **结构**: 包含技术选型、架构设计、接口定义、数据模型等
- **占位符**: `[技术栈]`、`[架构图]`、`[接口规范]` 等
- **适用**: 技术设计阶段，架构规划

#### 3. `tasks-template.md` - 任务规划模板
- **用途**: 将设计方案分解为具体的开发任务
- **结构**: 包含开发任务、测试任务、部署任务等清单
- **占位符**: `[任务列表]`、`[优先级]`、`[工期估算]` 等
- **适用**: 开发阶段，任务管理

#### 4. `roadmap-template.md` - 项目路线图模板
- **用途**: 生成项目整体进度规划
- **结构**: 包含里程碑、模块依赖、时间线等
- **占位符**: `[项目名称]`、`[里程碑]`、`[交付节点]` 等
- **适用**: 项目管理，整体规划

### 模板设计特征
- **占位符格式**: 使用 `[描述性名称]` 标记需要替换的内容
- **结构化内容**: 提供完整的章节框架和格式示例
- **指导性说明**: 包含填写提示和最佳实践建议
- **技术无关**: 适用于各种技术栈和项目类型

## 脚本规范

### 1. 脚本组织
- `scripts/` - 包含所有 Node.js 脚本文件
- `scripts/common.js` - 通用工具函数和实用工具

### 2. 脚本命名约定
- 使用连字符分隔的小写命名：`create-module.js`
- 脚本名称应清楚表达其功能
- 统一使用 `.js` 扩展名

### 3. 脚本内容要求
- 使用 Node.js 内置模块实现，无需额外依赖
- 包含必要的错误处理和参数验证
- 支持 `--json` 参数用于结构化输出
- 包含简要的脚本用途说明注释
- 脚本头部使用 `#!/usr/bin/env node` 声明

### 4. 技术要求
- **仅使用 Node.js 内置模块**：`fs`, `path`, `child_process`, `process`
- **严格禁止外部依赖**：不允许使用任何第三方 npm 包，确保脚本的轻量性和独立性
- **跨平台兼容**：确保在 Windows、macOS、Linux 上正常运行
- **轻量设计**：无需安装额外 npm 包依赖
- **错误处理**：合理的异常捕获和用户友好的错误信息

**重要约束**：
- ❌ 禁止添加任何 `require()` 第三方模块
- ❌ 禁止使用 `import` 外部包
- ✅ 只允许使用 Node.js 核心模块（如 `require('fs')`、`require('path')` 等）
- ✅ 允许引用同目录下的 `common.js` 工具函数

### 5. 通用脚本文件
- `common.js` - 包含共享的实用函数，如 `getRepoRoot()`, `getFeaturePaths()` 等
- 其他脚本通过 `require('./common')` 引用共享函数

## 项目宪法规范

### constitution.md 结构
```markdown
# 项目宪法 (Project Constitution)

## 核心原则
- 规范驱动开发
- 测试驱动开发
- 模块化架构
- 增量开发
- 简洁性原则

## 质量门禁
- 设计阶段检查点
- 实现阶段检查点
- 集成阶段检查点

## 开发流程约束
- 五步工作流程
- 文档要求
- 代码提交规范

## 技术约束
- 依赖管理
- 性能要求
- 安全考虑

## 项目特定约束
根据项目特点定制的约束条件

## 治理规则
- 宪法优先级
- 修正流程
- 质量保证
```

## 使用说明

### 自动应用场景
此默认工作流模板在以下情况下自动使用：

1. **标准项目初始化**
   ```bash
   rod init my-project --ai claude
   ```

2. **无指定模板时的默认选择**
   ```bash
   rod init --ai claude  # 在当前目录初始化
   ```

### 生成的项目结构
使用默认模板初始化后，将生成以下结构：
```
my-project/
├── .specify/
│   ├── templates/         # 复制的文档模板
│   │   ├── spec-template.md
│   │   ├── plan-template.md
│   │   ├── tasks-template.md
│   │   └── roadmap-template.md
│   ├── scripts/          # 工作流脚本
│   └── memory/           # 项目宪法
├── .claude/              # Claude AI 命令（如选择 Claude）
│   └── commands/
├── specs/                # 项目规范目录
│   ├── roadmap.md       # 项目路线图
│   └── modules/         # 模块目录
└── README.md            # 项目说明
```

### 与专用模板的区别
- **默认模板**: 通用工作流，适用于各种项目类型
- **专用模板** (如 PUI): 针对特定技术栈定制，包含专用命令和模板

### 适用项目类型
- Web 应用 (前端/后端/全栈)
- 移动应用 (iOS/Android/跨平台)
- 桌面应用 (Electron/Qt/Swing 等)
- 服务端应用 (API/微服务/单体应用)
- 命令行工具和脚本
- 数据处理和分析项目
- 其他软件开发项目

## 扩展和定制

### 创建专用模板
如需为特定技术栈创建专用模板，请参考 `packages/internal-templates/` 中的模板结构，确保包含：
- `commands/` - 专用 AI 命令
- `scripts/` - 专用自动化脚本
- `memory/` - 专用项目宪法
- `templates/` - 专用文档模板

### 模板继承
专用模板可以继承默认模板的结构和内容，在此基础上添加或覆盖特定部分，实现渐进式定制。
